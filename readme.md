# study-aid - 智能学习辅助平台

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Python](https://img.shields.io/badge/Python-3.9%2B-blue)](https://www.python.org/)
[![Vue](https://img.shields.io/badge/Vue-3.0%2B-green)](https://vuejs.org/)
[![FastAPI](https://img.shields.io/badge/FastAPI-Latest-red)](https://fastapi.tiangolo.com/)

study-aid是一个功能丰富的智能学习辅助平台，支持多种文档和视频内容的上传、解析、AI分析和可视化展示。通过集成先进的AI技术，能够自动提取内容、生成知识图谱和思维导图，提供PDF处理功能，并支持智能问答等多种学习辅助功能。演示视频见https://www.bilibili.com/video/BV1bZfMBQER1/?spm_id_from=333.1387.0.0&vd_source=3a088f8f77f388c1b1895e33ba8581a8

## 🚀 功能特性

### 🏗️ 技术架构

- **后端**: Python (FastAPI), LangChain (Agent框架), SQLAlchemy (ORM)
- **前端**: Vue 3, Vite, D3.js (思维导图可视化), vis-network (知识图谱可视化), Chart.js (数据图表可视化), ECharts (高级图表)
- **AI/ML**:
    - **LLM**: DashScope (通义千问)
    - **OCR**: RapidOCR (ONNX Runtime), PaddleOCR
    - **RAG**: Faiss (向量检索), SentenceTransformers
    - **视频处理**: 内置视频分析和摘要生成

### 📊 核心功能

#### 1. 智能文档分析
- **多格式支持**：支持PDF、TXT、LOG、JPG、JPEG、PNG等多种格式文件上传
- **AI深度分析**：基于千问API的文档内容智能分析
- **思维导图生成**：自动将文档内容转换为结构化的思维导图
- **知识图谱构建**：可视化展示文档中的实体关系和知识网络
- **智能问答**：基于文档内容的自然语言问答功能
- **高清导出**：支持将思维导图和知识图谱导出为高清图片（PNG/JPEG），最高支持20倍清晰度调节
- **节点编辑**：支持双击编辑节点内容，点击选中节点，选中时不会重新渲染整个图
- **节点增删**：支持在选中节点下添加子节点，删除选中节点，实时更新思维导图

#### 2. 智能视频分析
- **B站视频支持**：通过BV号或URL解析B站视频内容
- **视频播放**：直接在平台内嵌入播放B站视频
- **视频摘要生成**：AI自动分析视频内容并提取核心要点
- **思维导图构建**：将视频结构转换为可视化的思维导图，支持节点编辑、增删、高清导出（最高20倍清晰度）
- **视频智能问答**：基于视频内容回答用户的自然语言问题
- **学习笔记生成**：自动生成结构化的视频学习笔记
- **多格式URL支持**：兼容多种B站视频链接格式（直接BV号、完整URL等）
- **视频信息获取**：自动提取视频标题、作者、时长、描述等元数据

#### 3. PDF助手
- **PDF压缩**：智能压缩PDF文件大小，优化存储和传输，自动处理避免压缩后文件增大的情况
- **PDF旋转**：支持自定义旋转角度，可对单个页面或所有页面进行旋转操作
- **PDF拆分**：支持两种拆分模式：按指定页面位置拆分为两个文件，或按指定页数分页拆分
- **PDF合并**：将多个PDF文件合并为一个完整的PDF文档
- **图片提取**：从PDF中提取所有嵌入图片，保留原始图片格式和质量
- **文本提取**：从PDF中提取完整文本内容，支持后续编辑和分析
- **元数据获取**：提取PDF文件的详细元数据（标题、作者、创建日期、修改日期、总页数等）
- **文件管理**：提供PDF文件的上传、列表查看、分页浏览和删除功能
- **结果保存**：支持将所有操作结果（压缩、旋转、拆分、合并后的文件，提取的图片和文本）保存到本地

#### 4. 文件管理
- **文件列表查看**：展示所有上传文件的详细信息，包括文件名、大小、上传时间等
- **文件类型过滤**：支持按文件类型（PDF、TXT、图片等）筛选文件列表
- **分页浏览**：支持自定义每页显示数量（5/10/20/50），轻松浏览大量文件
- **文件信息展示**：格式化显示文件大小（B/KB/MB）和上传时间，方便查看文件详情
- **文件删除功能**：支持删除单个文件或批量删除所有文件，操作安全可靠
- **文件ID管理**：支持查看和复制文件ID，便于后续操作和引用
- **刷新功能**：一键刷新文件列表，实时查看最新上传的文件
- **操作状态反馈**：提供清晰的操作结果提示（成功、失败、超时等）

#### 5. 知识库管理
- 管理用户的知识库和学习资料
- 支持知识的分类和检索

#### 6. 高级数据分析
- **学习行为分析**：可视化展示学习时间分布和学习行为类型
- **学习预测分析**：基于历史数据预测完成时间和成功概率
- **学习对比分析**：与平均水平对比，提供改进建议
- **多模块支持**：分析所有学习模块的数据，而非单一模块
- **实时数据更新**：定时自动刷新数据，确保分析结果的及时性
- **预测生成**：支持手动触发预测生成，获取最新分析结果
- **数据可视化**：使用Chart.js绘制多种类型的图表（折线图、柱状图、雷达图等）

#### 7. 备用功能栏
- 展示项目未来开发计划和路线图

## 📋 环境要求

- **Python**: 3.9+
- **Node.js**: 16+
- **API Key**: DashScope Qwen API Key（用于AI分析功能）

## 🛠️ 安装与运行

### 1. 准备工作

克隆项目或直接解压项目包：

```bash
git clone <your-repo>
# 或直接解压项目包
cd study-aid
```

### 2. 安装依赖

#### 后端依赖

建议使用虚拟环境安装后端依赖：

```bash
# 创建虚拟环境
python -m venv venv

# 激活虚拟环境
# Windows: venv\Scripts\activate
# macOS/Linux: source venv/bin/activate

# 安装依赖
pip install -r requirements.txt
```

> [!TIP]
> **Conda 用户指南**
> 如果您使用 Conda，建议创建独立的虚拟环境以避免冲突：
> ```bash
> # 创建并激活环境
> conda create -n study-ai python=3.9
> conda activate study-ai
> 
> # 安装依赖
> pip install -r requirements.txt
> ```
> 注意：OCR 功能依赖 `rapidocr-onnxruntime`，请确保该包已正确安装。

#### 前端依赖

```bash
cd frontend
npm install
```

### 3. 配置API密钥

在项目根目录创建或编辑`.env`文件，添加DashScope Qwen API密钥：

```
DASHSCOPE_API_KEY=your_dashscope_api_key_here
```

### 4. 启动服务

#### 启动后端服务

在项目根目录下执行：

```bash
cd backend
uvicorn main:app --reload --port 8000
```

> 注意：后端服务默认运行在8000端口，若需修改，请同步更新前端axios配置

#### 启动前端服务

另开一个终端，执行：

```bash
cd frontend
npm run dev
```

### 5. 访问应用

打开浏览器访问：`http://localhost:5173`

## 📁 项目结构

```
study-aid/
├── backend/           # 后端代码
│   ├── agents/        # 多Agent智能分析系统
│   ├── knowledge/     # 知识框架抽取模块
│   ├── models/        # 数据模型定义
│   ├── parsers/       # 文件解析模块
│   ├── rag/           # 检索增强生成系统
│   ├── routes/        # API路由定义
│   ├── services/      # 系统服务组件
│   ├── utils/         # 工具函数和配置
│   └── main.py        # 后端入口
├── frontend/          # 前端代码
│   ├── src/           # 前端源代码
│   │   ├── components/# Vue组件
│   │   │   ├── AdvancedAnalytics.vue  # 高级数据分析组件
│   │   │   ├── FileManager.vue        # 文件管理组件
│   │   │   ├── KnowledgeGraph.vue     # 知识图谱组件
│   │   │   ├── LearningPlanManager.vue # 学习计划管理组件
│   │   │   ├── MindMap.vue            # 思维导图组件
│   │   │   └── ...                    # 其他组件
│   │   ├── styles/    # 样式文件
│   │   ├── views/     # 页面视图
│   │   ├── App.vue    # 根组件
│   │   └── main.js    # 前端入口
│   ├── index.html     # HTML模板
│   ├── package.json   # 前端依赖配置
│   ├── tailwind.config.js # Tailwind CSS配置
│   └── vite.config.js # Vite配置
├── models/            # 本地模型文件
│   ├── bge-small-zh/  # 中文文本嵌入模型
│   └── paddleocr/     # OCR文本识别模型
├── uploads/           # 上传文件存储目录
├── downloads/         # 下载文件存储目录
├── docmind.db         # SQLite数据库文件
├── .env               # 环境变量配置
├── requirements.txt   # Python依赖列表
└── readme.md          # 项目说明文档
```

## 🎯 使用指南

### 智能文档分析使用
1. **文件上传**：在"智能文档分析"页面点击上传按钮，选择要分析的文件（支持PDF、TXT、LOG、JPG、JPEG、PNG等格式）
2. **内容解析**：系统自动解析文件内容，提取文本和关键信息
3. **AI分析**：多Agent系统对文档内容进行深度分析
4. **可视化查看**：
   - 思维导图：展示文档的层次结构
   - 知识图谱：展示实体之间的关系
5. **节点操作**：
   - 双击节点：编辑节点内容
   - 单击节点：选中节点
   - 选中节点后，可通过工具栏按钮添加子节点或删除节点
6. **智能问答**：在问答区输入问题，基于文档内容获取答案
7. **导出功能**：
   - 导出思维导图为PNG/JPEG
   - 导出知识图谱为高清PNG/JPEG

### 智能视频分析使用
1. **视频输入**：在"智能视频分析"页面输入B站BV号或完整URL
2. **选择任务**：选择要执行的任务（视频播放、摘要生成、思维导图构建、智能问答、学习笔记生成）
3. **开始分析**：点击"开始分析"按钮，系统开始处理视频
4. **查看结果**：根据任务类型查看相应的结果
5. **导出内容**：支持导出思维导图、摘要等结果

### PDF助手使用
1. **文件上传**：在"PDF助手"页面点击上传按钮，选择要处理的PDF文件
2. **选择操作**：选择要执行的PDF操作（压缩、旋转、拆分、合并、提取图片、提取文本）
3. **设置参数**：根据操作类型设置相应参数
4. **开始处理**：点击对应的开始按钮，系统开始处理PDF
5. **下载结果**：处理完成后，点击下载按钮获取结果文件

### 文件管理使用
1. **文件列表查看**：在页面底部查看所有上传的文件，包括文件名、大小、上传时间等信息
2. **文件类型过滤**：可以根据文件类型（PDF、TXT、图片等）筛选文件列表
3. **分页浏览**：
   - 默认每页显示10个文件
   - 支持自定义每页显示数量（5/10/20/50）
   - 可以通过上一页/下一页按钮或直接跳转到指定页面
4. **文件删除**：
   - 点击单个文件旁的"删除"按钮删除特定文件
   - 点击"删除所有文件"按钮批量删除所有文件
   - 操作前会有确认提示，确保操作安全
5. **文件ID管理**：
   - 可以查看每个文件的唯一ID
   - 点击文件ID可直接复制，便于后续操作和引用
6. **刷新功能**：点击"刷新"按钮更新文件列表，查看最新上传的文件

### 高级数据分析使用
1. **访问分析页面**：在导航栏中选择"高级数据分析"页面
2. **数据初始化**：系统会自动初始化并加载所有学习模块数据
3. **查看学习行为分析**：
   - 学习时间分布图：展示24小时内的学习时长分布
   - 学习行为类型图：展示不同学习行为的发生次数
   - 学习行为详情表：查看最近的学习行为记录
4. **查看学习预测分析**：
   - 完成时间预测图：预测每个模块的预计完成时间
   - 成功概率分析图：分析每个模块的学习成功概率
5. **查看学习对比分析**：
   - 与平均进度对比
   - 查看个人百分位数
   - 获取系统生成的改进建议
6. **手动生成预测**：点击"生成预测"按钮获取最新的预测分析结果
7. **实时数据更新**：系统每10秒自动刷新数据，确保分析结果的及时性

## ⚙️ 配置说明

### 环境变量

在`.env`文件中配置以下环境变量：

- `DASHSCOPE_API_KEY`: 千问API密钥（必需）

### 前端配置

前端axios配置位于`main.js`文件中，默认使用`http://localhost:8000`作为后端API地址。若需修改，请更新：

```javascript
axios.defaults.baseURL = 'http://localhost:8000'
```

## 🧹 维护说明

### 清理上传文件

上传文件默认存储在`uploads/`目录下，系统会自动清理24小时前的过期文件。也可以手动清理：

```bash
# 清理所有上传文件
rm -rf uploads/*
```

### 清理下载文件

下载文件默认存储在`downloads/`目录下，建议定期清理：

```bash
# 清理所有下载文件
rm -rf downloads/*
```

### 模型更新

如需更新本地模型（如OCR模型、文本嵌入模型），请替换`models/`目录下对应的模型文件。

## 🤝 贡献

欢迎提交Issue和Pull Request来帮助改进study-ai！

请阅读 [贡献指南](CONTRIBUTING.md) 了解如何参与项目开发。

## 📄 开源许可

本项目采用 [MIT License](LICENSE) 开源许可证。

## 🌟 Star History

如果这个项目对你有帮助，请给我们一个 Star ⭐️

## 🙏 致谢

感谢所有为这个项目做出贡献的开发者！

---

[![Star History Chart](https://api.star-history.com/svg?repos=huochabu/study_aid&type=Date)](https://star-history.com/#huochabu/study_aid&Date)

## ❓ 常见问题 (FAQ)

### 1. 启动时提示 `rapidocr-onnxruntime` 相关错误？
**原因**：OCR 依赖包未正确安装。
**解决**：请手动安装该依赖：
```bash
pip install rapidocr-onnxruntime
```

### 2. Windows 下遇到编码错误？
**原因**：系统默认编码可能导致文件读取冲突。
**解决**：尝试在 PowerShell 中设置环境变量：
```bash
$env:PYTHONUTF8=1
```

### 3. 如何清理所有缓存和数据？
**解决**：手动删除 `uploads/`, `downloads/` 目录下的内容，并重置 `docmind.db`（如果需要）。

### 4. 如何修改后端服务端口？
**解决**：在启动后端服务时指定端口：
```bash
uvicorn main:app --reload --port 8000
```

### 5. 前端无法连接到后端？
**解决**：
1. 确保后端服务正在运行
2. 检查后端服务端口是否正确
3. 同步更新前端axios配置中的baseURL


## 📈 项目状态

### 当前版本
- **前端版本**: 0.2.0
- **后端版本**: 1.0.0

### 运行状态
- ✅ 后端服务正常运行
- ✅ 前端服务正常运行
- ✅ 数据库连接正常
- ✅ API接口可用
- ✅ 核心功能完整

### 最近更新
1. **高级数据分析功能修复**：
   - 修复了 `TypeError: Cannot read properties of null (reading 'ownerDocument')` 错误
   - 实现了多模块数据支持，不再只显示单一模块
   - 优化了图表渲染逻辑，增加了组件挂载状态检查
   - 修复了重复成功通知弹窗问题

2. **技术优化**：
   - 前端使用 Vue 3 组合式 API 重构
   - 后端 API 参数处理优化
   - 数据库查询性能改进
   - 错误处理机制增强

3. **功能增强**：
   - 实时数据更新机制
   - 多模块数据支持
   - 预测生成功能优化
   - 数据可视化效果改进

## 🎯 未来规划

1. **功能扩展**：
   - 个性化学习路径推荐
   - 学习进度跟踪和提醒
   - 多语言支持
   - 协作学习功能

2. **技术优化**：
   - 性能优化和缓存机制
   - 安全性增强
   - 部署和扩展性改进
   - 测试覆盖度提升

3. **用户体验**：
   - 响应式设计优化
   - 交互体验改进
   - 加载速度优化
   - 移动端适配

---

**study-aid** - 让学习更智能、更高效！
